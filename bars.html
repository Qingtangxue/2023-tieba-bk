<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´´å§åˆ—è¡¨ - ç™¾åº¦è´´å§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .navbar {
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FF6B35;
            text-decoration: none;
        }
        
        .navbar-nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        .nav-link {
            color: #666;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .nav-link:hover {
            color: #FF6B35;
        }
        
        .nav-link.active {
            color: #FF6B35;
            font-weight: 600;
        }
        
        .bars-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .page-header {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .page-header h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .search-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .search-input {
            flex: 1;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #FF6B35;
        }
        
        .search-btn {
            padding: 1rem 2rem;
            background: #FF6B35;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .filter-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .filter-tab {
            padding: 0.5rem 1rem;
            background: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-tab.active {
            background: #FF6B35;
            color: white;
        }
        
        .sort-options {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .sort-select {
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: white;
        }
        
        .bars-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .bar-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .bar-card:hover {
            transform: translateY(-2px);
        }
        
        .bar-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .bar-avatar {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background: linear-gradient(135deg, #FF8E53 0%, #FE6B8B 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            margin-bottom: 1rem;
        }
        
        .bar-info h3 {
            font-size: 1.2rem;
            margin-bottom: 0.25rem;
        }
        
        .bar-members {
            color: #666;
            font-size: 0.9rem;
        }
        
        .bar-description {
            color: #666;
            line-height: 1.4;
            margin-bottom: 1rem;
        }
        
        .bar-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #999;
        }
        
        .bar-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .btn-primary {
            background: #FF6B35;
            color: white;
        }
        
        .btn-primary:hover {
            background: #E05A2B;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid #FF6B35;
            color: #FF6B35;
        }
        
        .btn-outline:hover {
            background: #FF6B35;
            color: white;
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }
        
        .page-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .page-btn.active {
            background: #FF6B35;
            color: white;
            border-color: #FF6B35;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #666;
            background: white;
            border-radius: 12px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .navbar {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .navbar-nav {
                gap: 1rem;
            }
            
            .bars-container {
                padding: 0 1rem;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            .bars-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-tabs {
                overflow-x: auto;
                padding-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">ç™¾åº¦è´´å§</a>
        <div class="navbar-nav">
            <a href="index.html" class="nav-link" onclick="clearCacheAndNavigate('index.html')">é¦–é¡µ</a>
            <a href="bars.html" class="nav-link active">è´´å§</a>
            <a href="profile.html" class="nav-link">ä¸ªäººä¸­å¿ƒ</a>
            <span id="authLinks">
                <a href="login.html" class="nav-link">ç™»å½•</a>
                <a href="register.html" class="nav-link">æ³¨å†Œ</a>
            </span>
        </div>
    </nav>

    <div class="bars-container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="page-header">
            <h1>å‘ç°è´´å§</h1>
            
            <!-- æœç´¢æ  -->
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="æœç´¢è´´å§..." id="searchInput">
                <button class="search-btn" onclick="searchBars()">æœç´¢</button>
            </div>
            
            <!-- ç­›é€‰æ ‡ç­¾ -->
            <div class="filter-tabs">
                <button class="filter-tab active" onclick="filterBars('all')">å…¨éƒ¨</button>
                <button class="filter-tab" onclick="filterBars('tech')">ç§‘æŠ€</button>
                <button class="filter-tab" onclick="filterBars('entertainment')">å¨±ä¹</button>
                <button class="filter-tab" onclick="filterBars('sports')">ä½“è‚²</button>
                <button class="filter-tab" onclick="filterBars('life')">ç”Ÿæ´»</button>
                <button class="filter-tab" onclick="filterBars('game')">æ¸¸æˆ</button>
            </div>
            
            <!-- æ’åºé€‰é¡¹ -->
            <div class="sort-options">
                <span>æ’åºæ–¹å¼ï¼š</span>
                <select class="sort-select" id="sortSelect" onchange="sortBars()">
                    <option value="members">æˆå‘˜æ•°</option>
                    <option value="posts">å¸–å­æ•°</option>
                    <option value="activity">æ´»è·ƒåº¦</option>
                    <option value="new">æœ€æ–°åˆ›å»º</option>
                </select>
            </div>
        </div>

        <!-- è´´å§ç½‘æ ¼ -->
        <div class="bars-grid" id="barsGrid">
            <!-- è´´å§å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- åˆ†é¡µ -->
        <div class="pagination" id="pagination">
            <!-- åˆ†é¡µæŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        // è´´å§æ•°æ®
        const barsData = [
            {
                id: 1,
                name: 'ç¼–ç¨‹',
                description: 'åˆ†äº«ç¼–ç¨‹ç»éªŒï¼Œå­¦ä¹ æ–°æŠ€æœ¯ï¼Œè®¨è®ºå¼€å‘é—®é¢˜',
                members: '125,000',
                posts: '45,678',
                activity: 'é«˜',
                category: 'tech',
                followed: false
            },
            {
                id: 2,
                name: 'æ‘„å½±',
                description: 'æ‘„å½±çˆ±å¥½è€…èšé›†åœ°ï¼Œåˆ†äº«ä½œå“ï¼Œäº¤æµæŠ€å·§',
                members: '87,000',
                posts: '32,456',
                activity: 'ä¸­',
                category: 'life',
                followed: false
            },
            {
                id: 3,
                name: 'æ—…è¡Œ',
                description: 'åˆ†äº«æ—…è¡Œè§é—»ï¼Œæ”»ç•¥å¿ƒå¾—ï¼Œç¾æ™¯ç…§ç‰‡',
                members: '153,000',
                posts: '67,890',
                activity: 'é«˜',
                category: 'life',
                followed: false
            },
            {
                id: 4,
                name: 'ç¾é£Ÿ',
                description: 'åƒè´§çš„å¤©å ‚ï¼Œåˆ†äº«ç¾é£Ÿï¼Œäº¤æµçƒ¹é¥ªæŠ€å·§',
                members: '231,000',
                posts: '89,123',
                activity: 'æé«˜',
                category: 'life',
                followed: false
            },
            {
                id: 5,
                name: 'æ¸¸æˆ',
                description: 'æ¸¸æˆç©å®¶èšé›†åœ°ï¼Œæ”»ç•¥åˆ†äº«ï¼Œç»„é˜Ÿå¼€é»‘',
                members: '189,000',
                posts: '78,456',
                activity: 'æé«˜',
                category: 'game',
                followed: false
            },
            {
                id: 6,
                name: 'ç”µå½±',
                description: 'ç”µå½±çˆ±å¥½è€…äº¤æµå¹³å°ï¼Œå½±è¯„åˆ†äº«ï¼Œæ–°ç‰‡è®¨è®º',
                members: '142,000',
                posts: '56,789',
                activity: 'é«˜',
                category: 'entertainment',
                followed: false
            },
            {
                id: 7,
                name: 'ç¯®çƒ',
                description: 'ç¯®çƒçˆ±å¥½è€…èšé›†åœ°ï¼Œèµ›äº‹è®¨è®ºï¼ŒæŠ€å·§åˆ†äº«',
                members: '98,000',
                posts: '34,567',
                activity: 'ä¸­',
                category: 'sports',
                followed: false
            },
            {
                id: 8,
                name: 'å¥èº«',
                description: 'å¥èº«çˆ±å¥½è€…äº¤æµå¹³å°ï¼Œè®­ç»ƒè®¡åˆ’ï¼Œè¥å…»æŒ‡å¯¼',
                members: '76,000',
                posts: '23,456',
                activity: 'ä¸­',
                category: 'sports',
                followed: false
            },
            {
                id: 9,
                name: 'éŸ³ä¹',
                description: 'éŸ³ä¹çˆ±å¥½è€…äº¤æµå¹³å°ï¼Œæ­Œæ›²æ¨èï¼Œä¹å™¨å­¦ä¹ ',
                members: '113,000',
                posts: '42,345',
                activity: 'é«˜',
                category: 'entertainment',
                followed: false
            },
            {
                id: 10,
                name: 'è¯»ä¹¦',
                description: 'è¯»ä¹¦çˆ±å¥½è€…èšé›†åœ°ï¼Œä¹¦è¯„åˆ†äº«ï¼Œé˜…è¯»å¿ƒå¾—',
                members: '67,000',
                posts: '28,901',
                activity: 'ä¸­',
                category: 'life',
                followed: false
            },
            {
                id: 11,
                name: 'è‚¡ç¥¨',
                description: 'è‚¡ç¥¨æŠ•èµ„äº¤æµå¹³å°ï¼Œè¡Œæƒ…åˆ†æï¼ŒæŠ•èµ„ç­–ç•¥',
                members: '89,000',
                posts: '35,678',
                activity: 'é«˜',
                category: 'tech',
                followed: false
            },
            {
                id: 12,
                name: 'è¶³çƒ',
                description: 'è¶³çƒçˆ±å¥½è€…èšé›†åœ°ï¼Œèµ›äº‹è®¨è®ºï¼Œçƒé˜Ÿåˆ†æ',
                members: '121,000',
                posts: '49,012',
                activity: 'é«˜',
                category: 'sports',
                followed: false
            },
            {
                id: 13,
                name: 'åŠ¨æ¼«',
                description: 'åŠ¨æ¼«çˆ±å¥½è€…äº¤æµå¹³å°ï¼Œæ–°ç•ªè®¨è®ºï¼ŒåŒäººåˆ›ä½œ',
                members: '156,000',
                posts: '61,234',
                activity: 'æé«˜',
                category: 'entertainment',
                followed: false
            },
            {
                id: 14,
                name: 'å® ç‰©',
                description: 'å® ç‰©çˆ±å¥½è€…èšé›†åœ°ï¼Œé¥²å…»ç»éªŒï¼ŒèŒå® åˆ†äº«',
                members: '78,000',
                posts: '31,567',
                activity: 'ä¸­',
                category: 'life',
                followed: false
            },
            {
                id: 15,
                name: 'æ±½è½¦',
                description: 'æ±½è½¦çˆ±å¥½è€…äº¤æµå¹³å°ï¼Œè½¦å‹è¯„æµ‹ï¼Œé©¾é©¶æŠ€å·§',
                members: '94,000',
                posts: '38,901',
                activity: 'ä¸­',
                category: 'tech',
                followed: false
            },
            {
                id: 16,
                name: 'æ•°ç ',
                description: 'æ•°ç äº§å“çˆ±å¥½è€…èšé›†åœ°ï¼Œæ–°å“è¯„æµ‹ï¼Œä½¿ç”¨æŠ€å·§',
                members: '102,000',
                posts: '41,234',
                activity: 'é«˜',
                category: 'tech',
                followed: false
            }
        ];
        
        // å½“å‰ç­›é€‰å’Œæ’åºçŠ¶æ€
        let currentFilter = 'all';
        let currentSort = 'members';
        let currentPage = 1;
        const itemsPerPage = 6;
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€å¹¶æ›´æ–°å¯¼èˆªæ 
        function updateAuthStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const authLinks = document.getElementById('authLinks');
            
            if (isLoggedIn === 'true') {
                const username = localStorage.getItem('username') || 'ç”¨æˆ·';
                authLinks.innerHTML = `
                    <span style="color: #666;">æ¬¢è¿ï¼Œ${username}</span>
                    <a href="profile.html" class="nav-link">ä¸ªäººä¸­å¿ƒ</a>
                    <a href="#" class="nav-link" onclick="logout()">é€€å‡ºç™»å½•</a>
                `;
            }
        }
        
        // ç­›é€‰è´´å§
        function filterBars(category) {
            currentFilter = category;
            currentPage = 1;
            
            // æ›´æ–°ç­›é€‰æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderBars();
        }
        
        // æ’åºè´´å§
        function sortBars() {
            currentSort = document.getElementById('sortSelect').value;
            renderBars();
        }
        
        // æœç´¢è´´å§
        function searchBars() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm.trim() === '') {
                renderBars();
                return;
            }
            
            const filteredBars = barsData.filter(bar => 
                bar.name.toLowerCase().includes(searchTerm) ||
                bar.description.toLowerCase().includes(searchTerm)
            );
            
            renderBars(filteredBars);
        }
        
        // å…³æ³¨/å–æ¶ˆå…³æ³¨è´´å§
        function toggleFollow(barId) {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            
            if (!isLoggedIn || isLoggedIn !== 'true') {
                alert('è¯·å…ˆç™»å½•ï¼');
                window.location.href = 'login.html';
                return;
            }
            
            const bar = barsData.find(b => b.id === barId);
            if (bar) {
                bar.followed = !bar.followed;
                renderBars();
                
                if (bar.followed) {
                    alert(`å·²å…³æ³¨ ${bar.name}å§`);
                } else {
                    alert(`å·²å–æ¶ˆå…³æ³¨ ${bar.name}å§`);
                }
            }
        }
        
        // è¿›å…¥è´´å§
        function enterBar(barName) {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè·³è½¬åˆ°å…·ä½“çš„è´´å§é¡µé¢
            alert(`è¿›å…¥ ${barName}å§`);
            // window.location.href = `bar-detail.html?name=${barName}`;
        }
        
        // è·å–è´´å§è¡¨æƒ…ç¬¦å·
        function getBarEmoji(barName) {
            const emojiMap = {
                'ç¼–ç¨‹': 'ğŸ’»',
                'æ‘„å½±': 'ğŸ“·',
                'æ—…è¡Œ': 'ğŸ”ï¸',
                'ç¾é£Ÿ': 'ğŸ²',
                'æ¸¸æˆ': 'ğŸ®',
                'ç”µå½±': 'ğŸ¬',
                'ç¯®çƒ': 'ğŸ€',
                'å¥èº«': 'ğŸ’ª',
                'éŸ³ä¹': 'ğŸµ',
                'è¯»ä¹¦': 'ğŸ“š',
                'è‚¡ç¥¨': 'ğŸ“ˆ',
                'è¶³çƒ': 'âš½',
                'åŠ¨æ¼«': 'ğŸ­',
                'å® ç‰©': 'ğŸ¶',
                'æ±½è½¦': 'ğŸš—',
                'æ•°ç ': 'ğŸ“±'
            };
            
            return emojiMap[barName] || barName.charAt(0);
        }
        
        // æ¸²æŸ“è´´å§åˆ—è¡¨
        function renderBars(customData = null) {
            const barsGrid = document.getElementById('barsGrid');
            const pagination = document.getElementById('pagination');
            
            // è·å–ç­›é€‰åçš„æ•°æ®
            let filteredBars = customData || barsData;
            
            if (currentFilter !== 'all') {
                filteredBars = filteredBars.filter(bar => bar.category === currentFilter);
            }
            
            // æ’åºæ•°æ®
            filteredBars.sort((a, b) => {
                switch (currentSort) {
                    case 'members':
                        return parseInt(b.members.replace(',', '')) - parseInt(a.members.replace(',', ''));
                    case 'posts':
                        return parseInt(b.posts.replace(',', '')) - parseInt(a.posts.replace(',', ''));
                    case 'activity':
                        const activityOrder = { 'æé«˜': 4, 'é«˜': 3, 'ä¸­': 2, 'ä½': 1 };
                        return activityOrder[b.activity] - activityOrder[a.activity];
                    case 'new':
                        return b.id - a.id;
                    default:
                        return 0;
                }
            });
            
            // åˆ†é¡µè®¡ç®—
            const totalPages = Math.ceil(filteredBars.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedBars = filteredBars.slice(startIndex, endIndex);
            
            // æ¸²æŸ“è´´å§å¡ç‰‡
            if (paginatedBars.length === 0) {
                barsGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <h3>æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„è´´å§</h3>
                        <p>å°è¯•ä½¿ç”¨ä¸åŒçš„å…³é”®è¯æœç´¢</p>
                    </div>
                `;
            } else {
                barsGrid.innerHTML = paginatedBars.map(bar => `
                    <div class="bar-card">
                        <div class="bar-header">
                            <div class="bar-avatar">${getBarEmoji(bar.name)}</div>
                            <div class="bar-info">
                                <h3>${bar.name}å§</h3>
                                <div class="bar-members">${bar.members} æˆå‘˜</div>
                            </div>
                        </div>
                        
                        <div class="bar-description">${bar.description}</div>
                        
                        <div class="bar-stats">
                            <span>å¸–å­æ•°: ${bar.posts}</span>
                            <span>æ´»è·ƒåº¦: ${bar.activity}</span>
                        </div>
                        
                        <div class="bar-actions">
                            <button class="btn ${bar.followed ? 'btn-secondary' : 'btn-primary'}" 
                                    onclick="toggleFollow(${bar.id})">
                                ${bar.followed ? 'å·²å…³æ³¨' : 'å…³æ³¨'}
                            </button>
                            <button class="btn btn-outline" onclick="enterBar('${bar.name}')">
                                è¿›å…¥è´´å§
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            // æ¸²æŸ“åˆ†é¡µ
            if (totalPages > 1) {
                let paginationHTML = '';
                
                if (currentPage > 1) {
                    paginationHTML += `<button class="page-btn" onclick="changePage(${currentPage - 1})">ä¸Šä¸€é¡µ</button>`;
                }
                
                for (let i = 1; i <= totalPages; i++) {
                    paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                }
                
                if (currentPage < totalPages) {
                    paginationHTML += `<button class="page-btn" onclick="changePage(${currentPage + 1})">ä¸‹ä¸€é¡µ</button>`;
                }
                
                pagination.innerHTML = paginationHTML;
            } else {
                pagination.innerHTML = '';
            }
        }
        
        // åˆ‡æ¢é¡µé¢
        function changePage(page) {
            currentPage = page;
            renderBars();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // æ¸…é™¤ç¼“å­˜å¹¶å¯¼èˆª
        function clearCacheAndNavigate(url) {
            event.preventDefault();
            window.location.href = url + '?' + new Date().getTime();
        }
        
        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('username');
                localStorage.removeItem('email');
                window.location.href = 'index.html?' + new Date().getTime();
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateAuthStatus();
            renderBars();
            
            // æœç´¢æ¡†å›è½¦äº‹ä»¶
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchBars();
                }
            });
        });
    </script>
</body>
</html>